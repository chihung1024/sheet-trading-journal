<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æˆ‘çš„äº¤æ˜“å„€è¡¨æ¿</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://unpkg.com/naive-ui"></script>
    <style>
        body { background-color: #101014; color: #fff; font-family: sans-serif; padding: 20px; }
        .card { background: #18181c; padding: 20px; border-radius: 8px; margin-bottom: 20px; }
        .green { color: #63e2b7; }
        .red { color: #e88080; }
        table { width: 100%; border-collapse: collapse; }
        th, td { text-align: left; padding: 10px; border-bottom: 1px solid #333; }
    </style>
</head>
<body>
    <div id="app">
        <h1>ğŸ“ˆ äº¤æ˜“å„€è¡¨æ¿</h1>
        <p style="color: #666">æ›´æ–°æ™‚é–“: {{ updateTime }}</p>

        <div class="card">
            <h2>ç¸½è³‡ç”¢</h2>
            <div style="font-size: 2em; font-weight: bold;">
                ${{ totalValue }}
            </div>
        </div>

        <div class="card">
            <h3>æŒå€‰æ˜ç´°</h3>
            <table>
                <thead>
                    <tr>
                        <th>ä»£ç¢¼</th>
                        <th>è‚¡æ•¸</th>
                        <th>ç¾åƒ¹</th>
                        <th>æç›Š</th>
                    </tr>
                </thead>
                <tbody>
                    <tr v-for="stock in holdings" :key="stock.symbol">
                        <td><b style="font-size: 1.2em">{{ stock.symbol }}</b></td>
                        <td>{{ stock.qty }}</td>
                        <td>${{ stock.current_price }}</td>
                        <td :class="stock.pnl >= 0 ? 'red' : 'green'">
                            {{ stock.pnl >= 0 ? '+' : '' }}{{ stock.pnl }}
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        
        <div style="text-align: center; margin-top: 20px;">
            <a href="https://docs.google.com/spreadsheets" target="_blank" style="color: #63e2b7; text-decoration: none;">
                ğŸ“ å‰å¾€ Google Sheet è¨˜å¸³
            </a>
        </div>
    </div>

    <script>
        const { createApp, ref, onMounted } = Vue
        
        createApp({
            setup() {
                const totalValue = ref(0)
                const updateTime = ref('')
                const holdings = ref([])

                const fetchData = async () => {
                    // è®€å– GitHub ç”Ÿæˆçš„ data.json
                    try {
                        const res = await fetch('data.json')
                        const data = await res.json()
                        totalValue.value = data.total_value
                        updateTime.value = data.updated_at
                        holdings.value = data.holdings
                    } catch (e) {
                        console.error("é‚„æ²’ç”Ÿæˆ data.jsonï¼Œè«‹ç­‰å¾… Action åŸ·è¡Œ")
                    }
                }

                onMounted(fetchData)
                return { totalValue, updateTime, holdings }
            }
        }).mount('#app')
    </script>
</body>
</html>
